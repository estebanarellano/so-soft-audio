<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Audio Experience</title>
    <style>
        :root {
            --background: #ffffff;
            --foreground: oklch(0.145 0 0);
            --card: #ffffff;
            --card-foreground: oklch(0.145 0 0);
            --primary: #030213;
            --primary-foreground: oklch(1 0 0);
            --secondary: oklch(0.95 0.0058 264.53);
            --secondary-foreground: #030213;
            --muted: #ececf0;
            --muted-foreground: #717182;
            --accent: #e9ebef;
            --border: rgba(0, 0, 0, 0.1);
            --input-background: #f3f3f5;
            --radius: 0.625rem;
        }

        .dark {
            --background: oklch(0.145 0 0);
            --foreground: oklch(0.985 0 0);
            --card: oklch(0.145 0 0);
            --card-foreground: oklch(0.985 0 0);
            --primary: oklch(0.985 0 0);
            --primary-foreground: oklch(0.205 0 0);
            --secondary: oklch(0.269 0 0);
            --secondary-foreground: oklch(0.985 0 0);
            --muted: oklch(0.269 0 0);
            --muted-foreground: oklch(0.708 0 0);
            --accent: oklch(0.269 0 0);
            --border: oklch(0.269 0 0);
            --input-background: oklch(0.269 0 0);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--background);
            color: var(--foreground);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background 0.3s ease, color 0.3s ease;
        }

        .container {
            width: 90%;
            max-width: 600px;
            background: var(--card);
            border-radius: var(--radius);
            padding: 40px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px rgba(0, 0, 0, 0.06);
            border: 1px solid var(--border);
        }

        .theme-toggle {
            position: absolute;
            top: 20px;
            right: 20px;
            background: var(--secondary);
            color: var(--secondary-foreground);
            border: none;
            padding: 10px 20px;
            border-radius: var(--radius);
            cursor: pointer;
            font-weight: 500;
            transition: opacity 0.2s;
        }

        .theme-toggle:hover {
            opacity: 0.8;
        }

        .screen {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .screen.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h1 {
            font-size: 2em;
            margin-bottom: 16px;
            text-align: center;
            font-weight: 500;
            color: var(--foreground);
        }

        p {
            font-size: 1rem;
            margin-bottom: 24px;
            text-align: center;
            line-height: 1.5;
            color: var(--muted-foreground);
        }

        .btn {
            background: var(--primary);
            color: var(--primary-foreground);
            border: none;
            padding: 12px 32px;
            font-size: 1rem;
            border-radius: var(--radius);
            cursor: pointer;
            display: block;
            margin: 0 auto;
            transition: opacity 0.2s;
            font-weight: 500;
        }

        .btn:hover {
            opacity: 0.9;
        }

        .btn:active {
            opacity: 0.8;
        }

        .interaction-area {
            text-align: center;
            margin: 40px 0;
        }

        .morph-button {
            background: var(--primary);
            color: var(--primary-foreground);
            border: none;
            padding: 16px 48px;
            font-size: 1.1rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.5s ease;
            font-weight: 500;
        }

        .morph-button.morphing {
            width: 100%;
            border-radius: var(--radius);
            padding: 12px;
            cursor: default;
            background: var(--secondary);
            color: var(--secondary-foreground);
        }

        .slider-container {
            display: none;
            margin-top: 20px;
        }

        .slider-container.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        input[type="range"] {
            width: 100%;
            height: 6px;
            border-radius: var(--radius);
            background: var(--muted);
            outline: none;
            margin: 20px 0;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 2px solid var(--background);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 2px solid var(--background);
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }

        .slider-label {
            font-size: 1.3em;
            font-weight: 500;
            margin: 20px 0;
            color: var(--foreground);
        }

        .text-display {
            min-height: 120px;
            font-size: 1.2em;
            text-align: center;
            margin: 30px 0;
            line-height: 1.6;
            color: var(--foreground);
        }

        .text-display.typing {
            border-right: 2px solid var(--foreground);
            animation: blink 0.7s infinite;
        }

        @keyframes blink {
            0%, 100% { border-color: var(--foreground); }
            50% { border-color: transparent; }
        }

        .survey-form {
            margin-top: 30px;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--foreground);
        }

        .form-group input[type="text"],
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px 12px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
            font-size: 1rem;
            font-family: inherit;
            background: var(--input-background);
            color: var(--foreground);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 100px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .radio-group label {
            display: flex;
            align-items: center;
            gap: 8px;
            cursor: pointer;
            font-weight: 400;
        }

        .radio-group input[type="radio"] {
            cursor: pointer;
            width: 18px;
            height: 18px;
        }

        .loading-indicator {
            text-align: center;
            color: var(--muted-foreground);
            margin-top: 20px;
            font-style: italic;
        }
    </style>
</head>
<body>
    <button class="theme-toggle" onclick="toggleTheme()">Toggle Theme</button>
    
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcomeScreen" class="screen active">
            <h1>ðŸŽµ Welcome</h1>
            <p>Experience an interactive audio journey. Select your path and let the music guide you through a unique experience.</p>
            <button class="btn" onclick="startExperience()">Begin Experience</button>
        </div>

        <!-- Selection Screen -->
        <div id="selectionScreen" class="screen">
            <h1>Choose Your Path</h1>
            <p>Tap the button below to reveal your options</p>
            <div class="interaction-area">
                <button id="morphButton" class="morph-button" onclick="morphToSlider()">
                    Tap to Choose
                </button>
                <div id="sliderContainer" class="slider-container">
                    <div class="slider-label" id="sliderLabel">Calm</div>
                    <input type="range" id="audioSlider" min="1" max="3" value="1" step="1">
                    <button class="btn" onclick="playExperience()">Start Journey</button>
                </div>
            </div>
        </div>

        <!-- Experience Screen -->
        <div id="experienceScreen" class="screen">
            <h1>Your Journey</h1>
            <div class="text-display" id="textDisplay"></div>
            <div class="loading-indicator" id="loadingIndicator" style="display: none;">
                Loading audio...
            </div>
        </div>

        <!-- Survey Screen -->
        <div id="surveyScreen" class="screen">
            <h1>Share Your Thoughts</h1>
            <p>We'd love to hear about your experience</p>
            <form class="survey-form" onsubmit="submitSurvey(event)">
                <div class="form-group">
                    <label>How would you rate your experience?</label>
                    <div class="radio-group">
                        <label><input type="radio" name="rating" value="5" required> Excellent</label>
                        <label><input type="radio" name="rating" value="4"> Good</label>
                        <label><input type="radio" name="rating" value="3"> Fair</label>
                    </div>
                </div>
                <div class="form-group">
                    <label>Which aspect did you enjoy most?</label>
                    <select required>
                        <option value="">Select one...</option>
                        <option value="audio">The audio</option>
                        <option value="text">The text</option>
                        <option value="interaction">The interaction</option>
                        <option value="overall">Overall experience</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Additional comments (optional):</label>
                    <textarea placeholder="Share your thoughts..."></textarea>
                </div>
                <button type="submit" class="btn">Submit Feedback</button>
            </form>
        </div>
    </div>

    <script>
        // Audio files configuration - REPLACE THESE URLs WITH YOUR OWN
        const audioFiles = {
            1: 'audio/calm.mp3',      // Replace with your calm audio URL
            2: 'audio/energetic.mp3', // Replace with your energetic audio URL
            3: 'audio/mysterious.mp3' // Replace with your mysterious audio URL
        };

        const sliderOptions = ['Calm', 'Energetic', 'Mysterious'];
        let currentAudio = null;
        
        const experiences = {
            1: {
                text: "You find yourself in a peaceful meadow... The gentle breeze whispers through the grass... Birds sing softly in the distance... All is calm and serene."
            },
            2: {
                text: "Energy pulses through your veins! The rhythm drives you forward... Excitement builds with every beat... You feel alive and unstoppable!"
            },
            3: {
                text: "Shadows dance at the edge of perception... Ancient secrets wait to be discovered... The unknown beckons you deeper... What mysteries will you uncover?"
            }
        };

        // Theme toggle
        function toggleTheme() {
            document.body.classList.toggle('dark');
        }

        function showScreen(screenId) {
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            document.getElementById(screenId).classList.add('active');
        }

        function startExperience() {
            showScreen('selectionScreen');
        }

        function morphToSlider() {
            const button = document.getElementById('morphButton');
            const slider = document.getElementById('sliderContainer');
            
            button.classList.add('morphing');
            button.textContent = 'Select Your Experience';
            button.style.pointerEvents = 'none';
            
            setTimeout(() => {
                slider.classList.add('active');
            }, 300);
        }

        // Update slider label
        document.getElementById('audioSlider').addEventListener('input', function(e) {
            const label = document.getElementById('sliderLabel');
            label.textContent = sliderOptions[e.target.value - 1];
        });

        function typeText(text, element, speed = 50) {
            element.textContent = '';
            element.classList.add('typing');
            let i = 0;
            
            return new Promise((resolve) => {
                const interval = setInterval(() => {
                    if (i < text.length) {
                        element.textContent += text.charAt(i);
                        i++;
                    } else {
                        clearInterval(interval);
                        element.classList.remove('typing');
                        resolve();
                    }
                }, speed);
            });
        }

        async function playExperience() {
            const sliderValue = document.getElementById('audioSlider').value;
            const experience = experiences[sliderValue];
            const audioUrl = audioFiles[sliderValue];
            
            showScreen('experienceScreen');
            
            const textDisplay = document.getElementById('textDisplay');
            const loadingIndicator = document.getElementById('loadingIndicator');
            
            // Stop any currently playing audio
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }
            
            // Create new audio element
            currentAudio = new Audio(audioUrl);
            
            // Show loading indicator
            loadingIndicator.style.display = 'block';
            
            // Wait for audio to be ready
            currentAudio.addEventListener('canplaythrough', async () => {
                loadingIndicator.style.display = 'none';
                
                // Play audio
                try {
                    await currentAudio.play();
                } catch (error) {
                    console.log('Audio playback failed:', error);
                }
                
                // Type text while audio plays
                await typeText(experience.text, textDisplay);
                
                // Wait for audio to finish or wait a bit longer
                const remainingTime = (currentAudio.duration - currentAudio.currentTime) * 1000;
                setTimeout(() => {
                    showScreen('surveyScreen');
                }, Math.max(remainingTime, 1500));
            }, { once: true });
            
            // Handle loading errors
            currentAudio.addEventListener('error', () => {
                loadingIndicator.textContent = 'Audio file not found. Please check the audio file paths.';
                // Continue anyway after a delay
                setTimeout(async () => {
                    loadingIndicator.style.display = 'none';
                    await typeText(experience.text, textDisplay);
                    setTimeout(() => {
                        showScreen('surveyScreen');
                    }, 2000);
                }, 2000);
            });
            
            // Start loading the audio
            currentAudio.load();
        }

        function submitSurvey(event) {
            event.preventDefault();
            
            // Stop any playing audio
            if (currentAudio) {
                currentAudio.pause();
                currentAudio.currentTime = 0;
            }
            
            // Show thank you message
            alert('Thank you for your feedback!');
            
            // Reset form
            event.target.reset();
            
            // Reset slider
            document.getElementById('morphButton').classList.remove('morphing');
            document.getElementById('morphButton').textContent = 'Tap to Choose';
            document.getElementById('morphButton').style.pointerEvents = 'auto';
            document.getElementById('sliderContainer').classList.remove('active');
            document.getElementById('audioSlider').value = 1;
            document.getElementById('sliderLabel').textContent = 'Calm';
            
            // Return to welcome screen
            showScreen('welcomeScreen');
        }
    </script>
</body>
</html>